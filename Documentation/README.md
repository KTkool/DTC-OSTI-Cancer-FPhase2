DTC-OSTI-Cancer-F2
==================

Repository for the second phase of the MATLAB assessment, group F

Licensing:
The report attached to this piece of work was authored by Kathryn Atwell, Adam Berrington, Lucy Hutchinson, Ronja Woloszczuk and Islom Nazarov 2013, CC-BY-SA-3.0.
See http://creativecommons.org/licencses/by/3.0/

The data provided with this work was generated by Kathryn Atwell, Adam Berrington, Lucy Hutchinson, Ronja Woloszczuk and Islom Nazarov 2013, CC-BY-SA-3.0. 
See http://creativecommons.org/licencses/by/3.0/ 

The code attached to this piece of work was created by group F, Copyright 2013 Kathryn Atwell, Adam Berrington, Lucy Hutchinson, Ronja Woloszczuk and Islom Nazarov
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this code except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0



CODE VERSIONS
Since the model extension we wrote involved making changes to a large number of files, it was decided to keep this version of the code separate rather than merging. The folder Extended_Model contains code for running the extended simulation with 16 allowable cell states, including cells with increased mutation rate. The folder Original_Model contains a version more similar to the code we inherited, which was used to investigate the effect of a drug treatment (see report). Both versions contain similar files performing similar functions, but with the original version able to support 8 cell states and the extended version supporting 16.



MAINFILE

To run the simulation in MATLAB execute the function RunSimulation.m with the following options:
RunSimulation(Number_of_iterations, Seed_Mutations, Vis_Every_N_Iter, Save_Every_N_Iter, Params, Savename)

Seed_Mutations = 1 => Execute the if statements at the top of RunSimulation.m to place mutant cells at particular locations and particular iterations.
Seed_Mutations = 0 => All mutations occur at random 

Vis or Save_Every_N_Iter => How frequently to display the state to screen / save the state to an output variable

Savename => Name for the output .mat file.



OTHER SIMULATION FILES

setParams.m
  Initialises a structure with the following parameters:
  Glycolytic rate,
  Tumour cell acidity threshold,
  Normal cell acidity thereshold,
  Adaptation rate,
  Width of the grid,
  Height of the grid,
  Number of ATP molecules produced during complete oxydation,
  Minimum ATP for a cell to survive,
  Diffusion coefficient for glucose,
  Diffusion coefficient for oxygen,

InitialiseProblem.m
Initialise the problem using the params structure.

diffusion.m
Updates the concentration of diffusive species (oxygen & glucose) by solving a system of linear equations Matrix * x = b.

ATPUpdate.m
Updates the ATP matrix with both aerobic and anaerobic processes based on glucose and oxygen concentrations.

Pdeath.m
Creates a matrix holding the probabilities of cell death from low pH.

DivideStatus.m
Calculates the probability of survival as a function of ATP and subsequently creates a matrix with ones and zeros (1=divide).

StateUpdate.m
Updates the State matrix.
Cells can die from low ATP or pH as wells as detachment from basement membrane (if they are not hyperblastic).
Depending on probabilites in Pdivide, cells divide into available space  with highest O2 concentration.
Upon division both, mother and daughter cell, may undergo one of 4 mutations (normal, hyperblastic, glycolytic, acid-resistant).
State matrix is updated accordingly.

Visualisation.m
Creates a subplot to visualise the state of the different cells in different colours and displays the other continuous variables using heatmaps.



DATA PROCESSING FILES

StatePlot.m
Sums up the number of cells in each state at each saved iteration and plots the cell counts over time. For the extended model, cell states are grouped into classes for display, because plotting 16 graphs together becomes unreadable. Also in the extended model, this function plots an additional graph showing the proportion of Hyperplastic, Glycolytic, Acid Resistant cells that also have the high mutation rate geneotype.

MakeMovie.m
Produces a .avi movie showing the evolution of one of the system state matrices in time. The appearance of the data should be identical to that produced by the Visualisation function. Takes as input the storage matirix, a string indicating which variable is being plotted, the parameters used in the simulation, and a filename to give the .avi.

Play2Movies.m
Function that can read back two .avi movies and play them side by side in the same figure. Takes as input the two movie filenames.

setNewParams.m  
Script for setting up a parameter struct containing alternative values.

RunTwoParameterSets
Shortcut script encompassing both MakeMovie and Plot2Movies that runs two simulations with different parameter sets, makes movies, then plays them side by side. Takes a variable to plot as output, and generates 4 files: Output1.mat, Output2.mat, MovieNormal.avi and MovieNew.avi. 

